<Project Sdk="Microsoft.NET.Sdk">
	<PropertyGroup>
		<TargetFramework>net$targetframeworkversion$</TargetFramework>
		<LangVersion>9.0</LangVersion>
		<Nullable>enable</Nullable>
	</PropertyGroup>
	<PropertyGroup Label="8337224c9ad9e356:PreProc">
		<DebugType Condition="'$(DebugType)'!='full' And '$(DebugType)'!='pdbonly'" Label="8337224c9ad9e356:PreProc">pdbonly</DebugType>
	</PropertyGroup>
	<PropertyGroup>
		<DllExportIdent>0D4DAE2F-BA65-4222-AEAA-CC8A0A5FFAC6</DllExportIdent>
		<DllExportMetaLibName>DllExport.dll</DllExportMetaLibName>
		<DllExportNamespace>$safeprojectname$</DllExportNamespace>
		<DllExportDDNSCecil>true</DllExportDDNSCecil>
		<DllExportSkipOnAnyCpu>false</DllExportSkipOnAnyCpu>
		<DllExportPlatform>Auto</DllExportPlatform>
		<DllExportOrdinalsBase>1</DllExportOrdinalsBase>
		<DllExportGenExpLib>false</DllExportGenExpLib>
		<DllExportOurILAsm>false</DllExportOurILAsm>
		<DllExportSysObjRebase>false</DllExportSysObjRebase>
		<DllExportLeaveIntermediateFiles>true</DllExportLeaveIntermediateFiles>
		<DllExportTimeout>30000</DllExportTimeout>
		<DllExportPeCheck>2</DllExportPeCheck>
		<DllExportPatches>0</DllExportPatches>
		<DllExportPreProcType>25</DllExportPreProcType>
		<DllExportILMerge />
		<DllExportPostProcType>0</DllExportPostProcType>
	</PropertyGroup>
	<ItemGroup>
		<PackageReference Include="DllExport" Version="1.7.4" />
		<PackageReference Include="ilmerge">
			<Version>3.0.29</Version>
		</PackageReference>
		<PackageReference Include="Microsoft.CodeAnalysis.CSharp.Scripting" Version="3.11.0" />
	</ItemGroup>
	<Target Name="DllExportPreProc" BeforeTargets="DllExportMod" Label="8337224c9ad9e356:PreProc" Condition="'$(Platform)' != 'AnyCPU'">
		<Copy SourceFiles="$(DllExportMetaLibFullPath)" DestinationFolder="$(TargetDir)" SkipUnchangedFiles="true" OverwriteReadOnlyFiles="true" />
		<Exec Command="$(ILMergeConsolePath)  $(TargetFileName) /out:$(TargetFileName).ilm0.dll" WorkingDirectory="$(TargetDir)" ContinueOnError="true" />
		<Move SourceFiles="$(TargetDir)$(TargetFileName).ilm0.dll" DestinationFiles="$(TargetDir)$(TargetFileName)" OverwriteReadOnlyFiles="true" ContinueOnError="true" />
		<Delete Files="$(TargetDir)$(DllExportMetaLibName)" ContinueOnError="true" />
	</Target>
	<Target Name="DllExportPreProcAfter" AfterTargets="DllExportMod" Label="8337224c9ad9e356:PreProc">
		<Delete Files="$(TargetDir)$(TargetFileName).ilm0.pdb" ContinueOnError="true" />
	</Target>
	<ImportGroup Label=".NET DllExport">
		<Import Project="$(SolutionDir)packages\DllExport.1.7.4\tools\net.r_eg.DllExport.targets" Condition="Exists($([MSBuild]::Escape('$(SolutionDir)packages\DllExport.1.7.4\tools\net.r_eg.DllExport.targets')))" Label="8337224c9ad9e356" />
	</ImportGroup>
	<Target Name="DllExportRestorePkg" BeforeTargets="PrepareForBuild">
		<Error Condition="!Exists('$(SolutionDir)DllExport.bat')" Text="DllExport.bat is not found. Path: '$(SolutionDir)' - https://github.com/3F/DllExport" />
		<Exec Condition="('$(DllExportModImported)' != 'true' Or !Exists('$(SolutionDir)packages\DllExport.1.7.4\tools\net.r_eg.DllExport.targets')) And Exists('$(SolutionDir)DllExport.bat')" Command=".\DllExport.bat  -action Restore" WorkingDirectory="$(SolutionDir)" />
		<MSBuild Condition="'$(DllExportModImported)' != 'true'" Projects="$(SolutionDir)packages\DllExport.1.7.4\tools\net.r_eg.DllExport.targets" Targets="DllExportMetaXBaseTarget" Properties="TargetFramework=$(TargetFramework)">
			<Output TaskParameter="TargetOutputs" PropertyName="DllExportMetaXBase" />
		</MSBuild>
		<ItemGroup>
			<Reference Include="DllExport, PublicKeyToken=8337224c9ad9e356">
				<HintPath>$(SolutionDir)packages\DllExport.1.7.4\gcache\$(DllExportMetaXBase)\$(DllExportNamespace)\$(DllExportMetaLibName)</HintPath>
				<Private>False</Private>
				<SpecificVersion>False</SpecificVersion>
			</Reference>
		</ItemGroup>
	</Target>
	<Target Name="DllExportRPkgDynamicImport" BeforeTargets="PostBuildEvent" DependsOnTargets="GetFrameworkPaths" Condition="'$(DllExportModImported)' != 'true' And '$(DllExportRPkgDyn)' != 'false'">
		<MSBuild BuildInParallel="true" UseResultsCache="true" Projects="$(MSBuildProjectFullPath)" Properties="DllExportRPkgDyn=true" Targets="Build" />
	</Target>
</Project>